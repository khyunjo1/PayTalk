-- 단계별 주문 데이터 삭제 스크립트
-- 각 단계를 개별적으로 실행하여 안전하게 삭제할 수 있습니다.

-- ========================================
-- 1단계: 일일 메뉴 주문 데이터 삭제
-- ========================================
DELETE FROM daily_menu_orders;
SELECT '1단계 완료: 일일 메뉴 주문 데이터 삭제' as step_1;

-- ========================================
-- 2단계: 일반 주문 아이템 삭제
-- ========================================
DELETE FROM order_items;
SELECT '2단계 완료: 일반 주문 아이템 삭제' as step_2;

-- ========================================
-- 3단계: 주문 데이터 삭제
-- ========================================
DELETE FROM orders;
SELECT '3단계 완료: 주문 데이터 삭제' as step_3;

-- ========================================
-- 4단계: 일일 메뉴 관련 데이터 삭제 (선택사항)
-- ========================================
-- 아래 주석을 해제하여 일일 메뉴도 함께 삭제할 수 있습니다.
-- DELETE FROM daily_menu_items;
-- DELETE FROM daily_menus;
-- SELECT '4단계 완료: 일일 메뉴 데이터 삭제' as step_4;

-- ========================================
-- 5단계: ID 시퀀스 리셋 (UUID 사용으로 불필요)
-- ========================================
-- UUID를 사용하는 테이블들은 gen_random_uuid()로 ID를 생성하므로 시퀀스 리셋이 불필요합니다.
-- SELECT '5단계 완료: UUID 사용으로 시퀀스 리셋 불필요' as step_5;

-- ========================================
-- 최종 확인
-- ========================================
SELECT 
    '데이터 삭제 완료' as status,
    (SELECT COUNT(*) FROM orders) as remaining_orders,
    (SELECT COUNT(*) FROM order_items) as remaining_order_items,
    (SELECT COUNT(*) FROM daily_menu_orders) as remaining_daily_menu_orders;
